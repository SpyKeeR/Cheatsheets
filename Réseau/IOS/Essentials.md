# üåê Cisco IOS ‚Äî Aide-m√©moire

## üèóÔ∏è Architecture & M√©moire

### Composants Syst√®me
| M√©moire | Contenu | Persistance | Acc√®s |
|---------|---------|-------------|-------|
| **ROM** | Bootstrap, POST, mini-IOS (RxBoot) | Permanent | Lecture seule |
| **Flash** | Image IOS (.bin) | Non-volatile | Lecture/√âcriture |
| **NVRAM** | startup-config | Non-volatile | Configuration sauv√©e |
| **RAM** | running-config, tables, processus | Volatile | Donn√©es actives |

### Processus de D√©marrage
```
1. POST (Power-On Self Test) depuis ROM
2. Bootstrap charge IOS depuis Flash
3. IOS charge startup-config depuis NVRAM ‚Üí running-config
4. Si pas de startup-config ‚Üí Setup mode
```

### Registre de Configuration
```
0x2102 : Configuration normale (d√©faut)
0x2142 : Ignorer startup-config (recovery password)
0x2101 : Boot depuis ROM (mini-IOS)

# Modifier registre
(config)# config-register 0x2142
(config)# exit
# copy running-config startup-config
# reload
```

## üéØ Modes & Navigation CLI

### Hi√©rarchie des Modes
```
User EXEC                    Switch>
‚îú‚îÄ‚îÄ Privileged EXEC          Switch#
    ‚îú‚îÄ‚îÄ Global Config        Switch(config)#
        ‚îú‚îÄ‚îÄ Interface        Switch(config-if)#
        ‚îú‚îÄ‚îÄ Line            Switch(config-line)#
        ‚îú‚îÄ‚îÄ Router          Switch(config-router)#
        ‚îî‚îÄ‚îÄ VLAN            Switch(config-vlan)#
```

### Navigation Rapide
```cisco
enable                       # User ‚Üí Privileged
configure terminal           # Privileged ‚Üí Global config
interface fastethernet0/1    # ‚Üí Interface mode
line console 0              # ‚Üí Line mode
exit                        # Remonter d'un niveau
end                         # ‚Üí Privileged mode
Ctrl+Z                      # ‚Üí Privileged mode (raccourci)
```

### Raccourcis CLI
| Raccourci | Action |
|-----------|--------|
| `?` | Aide contextuelle |
| `Tab` | Auto-compl√©tion |
| `‚Üë` `‚Üì` | Historique commandes |
| `Ctrl+A` | D√©but de ligne |
| `Ctrl+E` | Fin de ligne |
| `Ctrl+U` | Effacer ligne |
| `Ctrl+C` | Interrompre commande |
| `Ctrl+Z` | Retour mode privil√©gi√© |

## üíæ Gestion Configuration

### Commandes Configuration Essentielles
```cisco
# Visualisation
show running-config          # Configuration active
show startup-config          # Configuration sauv√©e
show version                # Infos syst√®me, version IOS

# Sauvegarde
copy running-config startup-config    # Sauver config active
write memory                          # Alias de la commande pr√©c√©dente
copy running-config tftp:             # Backup vers TFTP

# Restauration
copy startup-config running-config    # Charger config sauv√©e
copy tftp: running-config             # Restaurer depuis TFTP
```

### Reset & Effacement
```cisco
# Effacer configuration
erase startup-config         # Supprimer config sauv√©e
delete flash:vlan.dat       # Supprimer base VLAN (switch)
reload                      # Red√©marrer √©quipement

# Factory reset complet
erase startup-config
delete flash:vlan.dat
reload
```

## üîß Configuration de Base

### Param√®tres Syst√®me
```cisco
# Identit√© √©quipement
(config)# hostname SWITCH-01
(config)# banner motd "Acc√®s autoris√© uniquement"

# Domaine & DNS
(config)# ip domain-name entreprise.local
(config)# ip name-server 8.8.8.8
(config)# ip name-server 8.8.4.4

# Horloge & NTP
(config)# clock timezone CET 1
(config)# ntp server 0.fr.pool.ntp.org
(config)# ntp server 1.fr.pool.ntp.org
```

### S√©curit√© Mots de Passe
```cisco
# Mot de passe enable
(config)# enable secret password123    # Chiffr√© (recommand√©)
(config)# enable password password123  # Clair (√©viter)

# Chiffrement mots de passe
(config)# service password-encryption  # Chiffrer mdp en clair

# Console
(config)# line console 0
(config-line)# password console123
(config-line)# login
(config-line)# exec-timeout 5 0        # Timeout 5 min

# VTY (Telnet/SSH)
(config)# line vty 0 15
(config-line)# password vty123
(config-line)# login
(config-line)# transport input ssh     # SSH seulement
```

### Configuration SSH
```cisco
# Pr√©requis SSH
(config)# hostname SWITCH-01
(config)# ip domain-name entreprise.local
(config)# crypto key generate rsa modulus 2048

# Utilisateur local
(config)# username admin privilege 15 secret admin123

# VTY pour SSH
(config)# line vty 0 15
(config-line)# login local
(config-line)# transport input ssh
(config-line)# exec-timeout 10 0

# Version SSH
(config)# ip ssh version 2
(config)# ip ssh time-out 60
(config-line)# ip ssh authentication-retries 3
```

## üåê Configuration R√©seau

### Interfaces & VLAN
```cisco
# Interface physique
(config)# interface fastethernet0/1
(config-if)# description "Serveur Web"
(config-if)# ip address 192.168.1.10 255.255.255.0
(config-if)# no shutdown
(config-if)# duplex full
(config-if)# speed 100

# VLAN (switch)
(config)# vlan 10
(config-vlan)# name ADMIN
(config-vlan)# exit
(config)# vlan 20
(config-vlan)# name USERS

# Port access
(config)# interface fastethernet0/2
(config-if)# switchport mode access
(config-if)# switchport access vlan 10

# Port trunk
(config)# interface fastethernet0/24
(config-if)# switchport mode trunk
(config-if)# switchport trunk allowed vlan 10,20,30
```

### Interface Virtuelle (SVI)
```cisco
# VLAN interface pour management
(config)# interface vlan 1
(config-if)# ip address 192.168.1.100 255.255.255.0
(config-if)# no shutdown
(config-if)# description "Management VLAN"

# Passerelle par d√©faut (switch L2)
(config)# ip default-gateway 192.168.1.1
```

## üì° Routage Basique

### Routes Statiques
```cisco
# Route statique
(config)# ip route 192.168.2.0 255.255.255.0 192.168.1.1
(config)# ip route 0.0.0.0 0.0.0.0 192.168.1.1    # Route par d√©faut

# Route avec interface de sortie
(config)# ip route 10.0.0.0 255.0.0.0 serial0/0/0

# Route flottante (backup)
(config)# ip route 192.168.2.0 255.255.255.0 192.168.1.2 20  # AD=20
```

### Routage Inter-VLAN (Router-on-a-Stick)
```cisco
# Interface principale
(config)# interface gigabitethernet0/0
(config-if)# no shutdown

# Sous-interfaces
(config)# interface gigabitethernet0/0.10
(config-subif)# encapsulation dot1q 10
(config-subif)# ip address 192.168.10.1 255.255.255.0

(config)# interface gigabitethernet0/0.20
(config-subif)# encapsulation dot1q 20
(config-subif)# ip address 192.168.20.1 255.255.255.0
```

## üõ†Ô∏è Recovery & Maintenance

### R√©cup√©ration Mot de Passe
```cisco
# M√©thode 1 : Registre config
1. Red√©marrer et Ctrl+Break ‚Üí ROMmon
2. confreg 0x2142
3. reset
4. copy startup-config running-config
5. (config)# enable secret nouveau_mdp
6. (config)# config-register 0x2102
7. copy running-config startup-config
8. reload
```

### Mode ROMmon
```
Acc√®s : Ctrl+Break durant boot
Commandes principales :
‚îú‚îÄ‚îÄ boot                     # D√©marrer image IOS
‚îú‚îÄ‚îÄ dir flash:              # Lister fichiers flash
‚îú‚îÄ‚îÄ confreg 0x2142          # Modifier registre
‚îú‚îÄ‚îÄ set                     # Variables environnement
‚îú‚îÄ‚îÄ reset                   # Red√©marrer
‚îî‚îÄ‚îÄ tftpdnld               # T√©l√©charger IOS (‚ö†Ô∏è efface flash)
```

### Restauration IOS via TFTP
```cisco
# Depuis mode privil√©gi√©
copy tftp: flash:
Source filename []? c2960-lanbasek9-mz.150-2.SE11.bin
Address or name of remote host []? 192.168.1.50
Destination filename [c2960-lanbasek9-mz.150-2.SE11.bin]? 

# Depuis ROMmon (urgence)
rommon 1> IP_ADDRESS=192.168.1.100
rommon 2> IP_SUBNET_MASK=255.255.255.0
rommon 3> DEFAULT_GATEWAY=192.168.1.1
rommon 4> TFTP_SERVER=192.168.1.50
rommon 5> TFTP_FILE=c2960-lanbasek9-mz.150-2.SE11.bin
rommon 6> tftpdnld
```

## üìä Monitoring & Diagnostic

### Commandes Show Essentielles
```cisco
# Syst√®me
show version                # Version IOS, uptime, mat√©riel
show running-config         # Configuration active
show startup-config         # Configuration sauv√©e
show flash:                 # Contenu m√©moire flash
show memory                 # Utilisation m√©moire
show processes             # Processus actifs

# Interfaces
show interfaces            # Toutes interfaces
show interface fa0/1       # Interface sp√©cifique
show interfaces status     # Statut compact (switch)
show interfaces trunk     # Ports trunk (switch)

# VLAN (switch)
show vlan brief           # VLANs configur√©s
show vlan id 10           # VLAN sp√©cifique
show interfaces switchport # Config switchport

# Routage
show ip route             # Table routage
show ip route summary     # R√©sum√© routes
show arp                 # Table ARP

# Logs
show logging             # Messages syst√®me
show logging | include ERROR
```

### Diagnostic Connectivit√©
```cisco
# Tests r√©seau
ping 8.8.8.8             # Test connectivit√©
traceroute 8.8.8.8       # Trace route
telnet 192.168.1.1 23    # Test port TCP

# Debug (attention production!)
debug ip icmp            # Debug ICMP
debug ip routing         # Debug routage
undebug all             # Arr√™ter tous debug
```

## üîí S√©curit√© & Bonnes Pratiques

### Hardening Basique
```cisco
# S√©curiser console
(config)# line console 0
(config-line)# exec-timeout 5 0
(config-line)# logging synchronous

# S√©curiser VTY
(config)# line vty 0 15
(config-line)# exec-timeout 10 0
(config-line)# transport input ssh
(config-line)# access-class 10 in    # ACL pour limiter acc√®s

# D√©sactiver services non utilis√©s
(config)# no ip http-server
(config)# no cdp run
(config)# no service finger
```

### Sauvegarde Configuration
```cisco
# Backup automatique
(config)# archive
(config-archive)# path tftp://192.168.1.50/backups/$h-$t
(config-archive)# write-memory
(config-archive)# time-period 1440    # Sauvegarde quotidienne
```

## üîß Console & Acc√®s Physique

### Param√®tres Connexion Console
```
Port : RJ-45 ou USB mini-B (selon mod√®le)
Param√®tres s√©rie :
‚îú‚îÄ‚îÄ Vitesse : 9600 bauds
‚îú‚îÄ‚îÄ Bits donn√©es : 8
‚îú‚îÄ‚îÄ Parit√© : Aucune
‚îú‚îÄ‚îÄ Bits d'arr√™t : 1
‚îî‚îÄ‚îÄ Contr√¥le flux : Aucun
```

### Outils Connexion
- **Windows** : PuTTY, Tera Term, HyperTerminal
- **Linux** : minicom, screen, picocom
- **macOS** : screen, Terminal

## üí° Astuces & Raccourcis

### Configuration Rapide
- **Tab** : Auto-compl√©tion (gain de temps √©norme)
- **?** : Aide contextuelle √† n'importe quel moment
- **show run | begin interface** : Afficher config depuis "interface"
- **show run | include password** : Filtrer lignes contenant "password"
- **terminal length 0** : D√©sactiver pagination temporairement

### Troubleshooting Rapide
1. **Physique** : `show interfaces` ‚Üí √©tat up/down
2. **L2** : `show mac address-table` ‚Üí apprentissage MAC
3. **L3** : `show ip route` ‚Üí table routage
4. **Connectivit√©** : `ping`, `traceroute`
5. **Configuration** : `show running-config`

### Commandes One-liner Utiles
```cisco
# Voir ports utilis√©s
show interfaces status | exclude notconnect

# Sauver et red√©marrer
copy run start && reload

# Effacer et red√©marrer (factory reset)
erase startup-config && delete flash:vlan.dat && reload
```

---
**üí° Memo** : Mode strict = `enable secret` + `service password-encryption` + SSH only + timeouts configur√©s !