# Sauvegarde & Restauration ‚Äî Veritas / Veeam 

## Outils
- **Veritas Backup Exec** : UI centralis√©e (Accueil, Sauvegarde/Restauration, Moniteur, Stockage, Rapports). Flux : ajouter magasin ‚Üí ajouter serveur ‚Üí cr√©er job de sauvegarde.
- **Veeam Backup & Replication** : VM-focused (vSphere/Hyper-V), VSS support, sauvegarde image-level, restauration granulaire, r√©plication, Backup Copy, cloud & tape support.

## Principales fonctions
- Sauvegarde compl√®te / diff√©rentielle / incr√©mentale (avantages/inconv√©nients rapides).  
- Snapshots coh√©rents via VSS (application-aware) ‚Üí sauvegarde d‚ÄôAD/BDD coh√©rente.  
- Restauration granulaire (fichiers, √©l√©ments d‚Äôapplication, GPO).  
- R√©plication (failover) vs Duplication (copie fig√©e).  
- Backup Copy ‚Üí duplication r√©guli√®re vers repo distant / cloud.  
- Support tape pour archivage long terme / air-gap.

## Principe 3-2-1-1-0
- 3 copies, 2 types de supports, 1 hors-site, 1 copie isol√©e, 0 erreur de restauration.  
- Sauvegarde locale rapide (disk/NAS/SAN) + offsite (cloud/site distant).
- Ajouter 1 copie isol√©e (air-gapped / Object Lock) pour ransomware.  
- Comptes d√©di√©s (AD), groupe ¬´ Op√©rateur de sauvegarde ¬ª, least privilege.  
- Tests r√©guliers de restauration (valider RTO/RPO).

## Plan de sauvegarde (doit inclure)
- P√©rim√®tre (VM, BDD, fichiers, AD).  
- Types & fr√©quences, r√©tentions.  
- Supports (disk, NAS, SAN, tape, cloud).  
- Workflow de restauration (file, VM, bare-metal, AD, BDD).  
- Tests et rotation GFS (Daily/Weekly/Monthly).  
- Proc√©dure de destruction s√©curis√©e des supports obsol√®tes.

## Restauration
- Fichier ‚Üí restaurer sur l‚Äôorigin ou emplacement alternatif (pr√©f√©rer alt).  
- VM compl√®te ‚Üí restauration image / quick-restore.  
- Bare-metal recovery ‚Üí rebuild + image restore.  
- AD : objets simples via Corbeille AD ; DC perdu ‚Üí restauration image syst√®me coh√©rente + v√©rifier r√©plication.  
- BDD : SQL via SSMS, MySQL via dump (`mysql --user=... --password=... < dump.sql`), Oracle via RMAN/datadump.  
- Toujours isoler restauration AD/BDD et utiliser Application-Aware Processing.

## R√©plication vs Duplication
- **R√©plication** : copie synchronis√©e (RTO court), n√©cessite stockage accessible sur h√¥tes cibles ; ne pas d√©marrer manuellement un replica hors console.  
- **Duplication** : copie fig√©e, utile pour distribution/archivage.

## Planification & supervision
- Jobs planifi√©s + notifications mail (filtrer alertes critiques).  
- Consoles : monitoring, rapports quotidiens, alerte en cas d‚Äô√©chec.  
- Conserver logs et suivre tests de restauration.

## Storage & protocoles recommand√©s
- Utiliser SAN (iSCSI/FC) ou NAS selon besoin ; r√©server r√©seau iSCSI (MTU 9000, redondance).  
- VMFS / NFS pour datastores.  
- Pr√©f√©rer adaptateurs physiques (HBA) pour perf sur SAN ; software initiator acceptable mais CPU-consommant.

## Application-aware & coh√©rence
- Activer Application-Aware Processing pour AD, SQL, Exchange ‚Üí VSS snapshots coh√©rents.  
- Compte de sauvegarde doit avoir droits n√©cessaires (mais limiter au minimum).

## Snapshots
- Snapshot = clich√© instantan√© via VSS (consistency).  
- Ne pas confondre avec snapshot hyperviseur (pas de coh√©rence app, impact perf, pas une sauvegarde).  
- Utiliser snapshots hyperviseur pour tests/updates rapides, pas pour sauvegarde.

## Tape & archivage long terme
- Usage : archivage, air-gap, immutabilit√©.  
- Planifier catalogue, √©tiquetage, rotation et destruction.

## Tests & conformit√©
- Tester restaurations (0 erreur id√©al).  
- Documenter proc√©dures PCA (pr√©vention continuit√©) vs PRA (restauration apr√®s incident).  
- Conserver preuve des tests pour audits.

## Rotation GFS (Grand-Father / Father / Son)
- **Fils (quotidien)** üë∂ : sauvegarde quotidienne, recycl√©e tous les 4 jours.  
- **P√®re (hebdo)** üë® : archive chaque fin de semaine, conserv√©e ‚âà 5 semaines.  
- **Grand-P√®re (mensuel)** üë¥ : archive fin de mois, conserv√©e ‚âà 12 mois.  
- Exemple 5-jours ‚Üí besoin ‚âà 21 bandes/an (cycle expliqu√© ‚Üí r√©utilisation hebdo/mensuelle).

## Modes de sauvegarde
- **Chaude (hot)** üî• : sauvegarde en cours d‚Äôutilisation (VSS/app-aware) ‚Äî acc√®s continu, +complexe, ressources √©lev√©es.  
- **Froide (cold)** ‚ùÑÔ∏è : arr√™t/lock fichiers pendant la sauvegarde ‚Äî simple, interruption service.
- **Snapshot** üì∏ : clich√© instantan√© (VSS) ‚Äî rapide, coh√©rent, n√©cessite espace disque.

## Bases de donn√©es ‚Äî m√©thodes courantes (exemples)
- **SQL Server** : sauvegarde via SSMS (GUI) ou scripts T-SQL.  
- **MySQL** : dump SQL ‚Üí `mysqldump -u username -p"password" [options] database > dump.sql`  
- **Oracle** : RMAN ‚Üí `rman target /` puis `backup incremental level 0 ... plus archivelog;`  
- **Bonnes pratiques DB** : backups application-aware, comptes d√©di√©s, test restauration, s√©parer logs / data.

## Architecture logicielle & composants
- Logiciel de sauvegarde (orchestrateur), ordonnanceur, stockage physique, catalogues / journaux.  
- Types de stockage historiques ‚Üí cartes perfor√©es ‚Üí bandes ‚Üí HDD/SSD ‚Üí NAS/SAN/cloud.

## Supports & crit√®res (tr√®s synth√©tique)
- CD/DVD/Blu-ray : faible capacit√©.  
- HDD : bon march√©, sensible aux chocs.  
- SSD : rapide, co√ªteux.  
- Cl√© USB / cartes m√©moire : pratique, fiabilit√© moyenne.  
- Bande magn√©tique (LTO) : grande long√©vit√©, automatisable (robots).  
- RDX : disque portable modulaire.  
- NAS : partage fichier (SMB/NFS), RAID souvent int√©gr√©, saturable r√©seau.  
- SAN : mode bloc (iSCSI/FC), hautes perf, complexe.  
- Cloud : accessible, d√©pendant r√©seau, latence, co√ªts.

**Choix selon** : capacit√©, fiabilit√©, temps RTO/RPO, co√ªt, s√©curit√©, conformit√©.

## DAS / NAS / SAN (rappel / synth√®se)
- **DAS** : direct √† serveur (simple, local).  
- **NAS** : fichier sur r√©seau (CIFS/SMB/NFS), bon pour partages.  
- **SAN** : bloc d√©di√© (iSCSI/FC), meilleur perf pour serveurs/VMs critiques.

## Classes de sauvegarde (acc√®s/latence)
- **Inline** : d√©duplication en temps r√©el pendant sauvegarde.  
- **Online** : stockage actif, acc√®s imm√©diat.  
- **Near-line** : disque peu sollicit√©, acc√®s rapide mais pas instantan√©.  
- **Offline** : supports d√©connect√©s (bandes) ‚Äî air-gap possible.
- **Archival** : stockage long terme, acc√®s lent (cloud froid, bandes archivage).

## RAID ‚Äî synth√®se (choisir selon perf vs s√©curit√©)
- RAID 0 : striping, perf, **pas** de redondance.  
- RAID 1 : mirroring, tol√©rance (capacit√© √∑2).  
- RAID 5/6 : striping + parit√© (3+ disques), bon compromis; RAID6 tol√®re 2 pannes.  
- RAID 10 : mirroring + striping, perf + redondance (capacit√© √∑2).

**Mat√©riel vs logiciel** : mat√©riel = +perf/fiable; logiciel = +flexible/moins cher.

## Strat√©gie recommand√©es
- Appliquer r√®gle **3-2-1** (+ air-gap si possible).  
- S√©parer sauvegarde locale / offsite (cloud ou site distant).  
- D√©dier comptes & groupes (ex : Op√©rateur sauvegarde).  
- Activer Application-Aware (VSS/RMAN) pour AD/BDD.  
- Planifier GFS + tests de restauration r√©guliers (document√©s).  
- Choisir supports selon RTO/RPO, co√ªt, s√©curit√© et conformit√©.

## Points op√©rationnels rapides
- Automatiser via ordonnanceur, surveiller logs & alertes, filtrer notifications.  
- Cataloguer supports (bandes) & g√©rer rotation physique.  
- Valider immutabilit√©/retention (cloud Object Lock / WORM bandes) pour ransomware.
- Documenter proc√©dures PCA/PRA, conserver preuves tests pour audits.